"0","custom_boxplots <- function(bstats,"
"0","                            out = NULL,"
"0","                            box_width = 0.35,"
"0","                            whisker_lty = 3,"
"0","                            whisker_col = 'black',"
"0","                            whisker_lwd = 2,"
"0","                            whisker_width = 0.35,"
"0","                            box_col = 'gray',"
"0","                            box_lwd = 2,"
"0","                            box_lty = 1,"
"0","                            box_labels_tf = FALSE,"
"0","                            box_labels = 'boxn',"
"0","                            label_srt = 25,"
"0","                            label_pos = 1,"
"0","                            label_col = 'black',"
"0","                            label_cex = 1,"
"0","                            label_y_offset = 0.015,"
"0","                            box_border = 'black',"
"0","                            ylab = '',"
"0","                            xlab = '',"
"0","                            xaxt = 'n',"
"0","                            yaxt = NULL,"
"0","                            cex.lab = 1,"
"0","                            cex.axis = 1,"
"0","                            main = '',"
"0","                            title = NULL,"
"0","                            title_x_offset = 0.01,"
"0","                            title_y_offset = 0.07,"
"0","                            title_pos = 4,"
"0","                            title_cex = 1.6,"
"0","                            title_col = 'black',"
"0","                            subtitle = NULL,"
"0","                            subtitle_x_offset = 0.01,"
"0","                            subtitle_y_offset = 0.03,"
"0","                            subtitle_pos = 4,"
"0","                            subtitle_cex = 1.1,"
"0","                            subtitle_col = 'gray40',"
"0","                            mar = c(5.1,4.1,4.1,2.1),"
"0","                            grid = TRUE,"
"0","                            grid_col = 'gray40',"
"0","                            grid_lty = 3,"
"0","                            grid_lwd = 1,"
"0","                            plotbg = 'gray95')"
"0","{"
"0","  if(!'matrix' %in% class(bstats)){"
"0","    stop(paste0('\nerror encountered when running custom_boxplots:\n',"
"0","                'bstats is not an array'))"
"0","  }"
"0","  # ================================================================================================="
"0","  # ensure that the number of arguments matches the number of boxes"
"0","  # ================================================================================================="
"0","  ensure_argument_lengths <- function(args){"
"0","    # ------------------------------------------------------------------------------------------------"
"0","    # for each argument ensure user has entered correct number of arguments"
"0","    for(i in 1:length(args)){"
"0","      # ------------------------------------------------------------------------------------------------"
"0","      # if length of argument is incorrect"
"0","      if(length(args[[i]]) %% n_boxes != 0){"
"0","        # ------------------------------------------------------------------------------------------------"
"0","        # case where user has entered too many arguments"
"0","        if(length(args[[i]]) > n_boxes){"
"0","          end_missing_position <- min(c(length(args[[i]]),"
"0","                                        n_boxes))"
"0","          args[[i]] <- args[[i]][1:end_missing_position]"
"0","        }"
"0","        # ------------------------------------------------------------------------------------------------"
"0",""
"0","        # ------------------------------------------------------------------------------------------------"
"0","        # case where user has entered not enough arguments"
"0","        if(length(args[[i]]) < n_boxes){"
"0","          while(length(args[[i]]) < n_boxes){"
"0",""
"0","            n_missing <- n_boxes - length(args[[i]])"
"0",""
"0","            # ------------------------------------------------------------------------------------------------"
"0","            # if all is needed is a simple append statement"
"0","            if(n_missing < length(args[[i]])){"
"0","              args[[i]] <- append(args[[i]],"
"0","                                  args[[i]][1:n_missing])"
"0","            }"
"0","            # ------------------------------------------------------------------------------------------------"
"0",""
"0","            # ------------------------------------------------------------------------------------------------"
"0","            # if a rep and an append are needed"
"0","            if(n_missing > length(args[[i]])){"
"0","              rep_n <- floor(n_boxes/length(args[[i]]))"
"0","              args[[i]] <- rep(args[[i]],rep_n)"
"0","            }"
"0","            # ------------------------------------------------------------------------------------------------"
"0","          }"
"0","        }"
"0","        # ------------------------------------------------------------------------------------------------"
"0","      }"
"0","      # ------------------------------------------------------------------------------------------------"
"0","    }"
"0","    # ------------------------------------------------------------------------------------------------"
"0","    return(args)"
"0","  }"
"0","  # ------------------------------------------------------------------------------------------------"
"0",""
"0",""
"0","  # ------------------------------------------------------------------------------------------------"
"0","  # ensure argument lengths match n_boxes"
"0","  n_boxes <- ncol(bstats)"
"0","  args <- ensure_argument_lengths(list(whisker_lty,"
"0","                                       whisker_col,"
"0","                                       whisker_lwd,"
"0","                                       whisker_width,"
"0","                                       box_col,"
"0","                                       box_lwd,"
"0","                                       box_lty,"
"0","                                       box_border,"
"0","                                       box_width,"
"0","                                       box_labels,"
"0","                                       label_srt,"
"0","                                       label_col,"
"0","                                       label_cex,"
"0","                                       label_y_offset))"
"0","  whisker_lty <- args[[1]]"
"0","  whisker_col <- args[[2]]"
"0","  whisker_lwd <- args[[3]]"
"0","  whisker_width <- args[[4]]"
"0","  box_col <- args[[5]]"
"0","  box_lwd <- args[[6]]"
"0","  box_lty <- args[[7]]"
"0","  box_border <- args[[8]]"
"0","  box_width <- args[[9]]"
"0","  box_labels <- args[[10]]"
"0","  label_srt <- args[[11]]"
"0","  label_col <- args[[12]]"
"0","  label_cex <- args[[13]]"
"0","  label_y_offset <- args[[14]]"
"0","  # ------------------------------------------------------------------------------------------------"
"0","  "
"0","  "
"0","  # ------------------------------------------------------------------------------------------------"
"0","  # plot outliars or not"
"0","  if(is.null(out) == FALSE){"
"0","    # ------------------------------------------------------------------------------------------------"
"0","    # basic plotting positions"
"0","    n_boxes <- ncol(bstats)"
"0","    box_positions <- list()"
"0","    for(i in 1:n_boxes){"
"0","      box_positions[[i]] <- c(rep(i,nrow(bstats)),"
"0","                              rep(i,length(out[[i]])))"
"0","    }"
"0","    # box_positions_wide <- do.call(cbind, box_positions)"
"0","    box_positions_long <- as.vector(unlist(box_positions))"
"0","    # ------------------------------------------------------------------------------------------------"
"0","    "
"0","    # ------------------------------------------------------------------------------------------------"
"0","    # long format for plotting"
"0","    bstats_long <- matrix(c(bstats[,1],out[[1]]),"
"0","                          ncol = 1)"
"0","    bstats_wide <- bstats"
"0","    if(ncol(bstats) > 1){"
"0","      for(i in 2:ncol(bstats)){"
"0","        bstats_long <- rbind(bstats_long,"
"0","                             matrix(c(bstats[,i],out[[i]]),"
"0","                                    ncol = 1))"
"0","      }"
"0","    }"
"0","    # ------------------------------------------------------------------------------------------------"
"0","  } else {"
"0","    # ------------------------------------------------------------------------------------------------"
"0","    # basic plotting positions"
"0","    n_boxes <- ncol(bstats)"
"0","    box_positions <- list()"
"0","    for(i in 1:n_boxes){"
"0","      box_positions[[i]] <- c(rep(i,nrow(bstats)))"
"0","    }"
"0","    # box_positions_wide <- do.call(cbind, box_positions)"
"0","    box_positions_long <- as.vector(unlist(box_positions))"
"0","    # ------------------------------------------------------------------------------------------------"
"0","    "
"0","    # ------------------------------------------------------------------------------------------------"
"0","    # long format for plotting"
"0","    bstats_long <- matrix(c(bstats[,1]),"
"0","                          ncol = 1)"
"0","    bstats_wide <- bstats"
"0","    if(ncol(bstats) > 1){"
"0","      for(i in 2:ncol(bstats)){"
"0","        bstats_long <- rbind(bstats_long,"
"0","                             matrix(bstats[,i],"
"0","                                    ncol = 1))"
"0","      }"
"0","    }"
"0","    # ------------------------------------------------------------------------------------------------"
"0","  }"
"0","  # ------------------------------------------------------------------------------------------------"
"0","  "
"0","  "
"0","  # ------------------------------------------------------------------------------------------------"
"0","  par(mar = c(mar))"
"0","  plot(x = box_positions_long,"
"0","       y = bstats_long,"
"0","       xlim = c(1 - 0.5,"
"0","                n_boxes + 0.5),"
"0","       xaxt = xaxt,"
"0","       yaxt = yaxt,"
"0","       bg = plotbg,"
"0","       xlab = xlab,"
"0","       ylab = ylab,"
"0","       main = main,"
"0","       cex.lab = cex.lab,"
"0","       cex.axis = cex.axis,"
"0","       col = 'white')"
"0","  if(grid == TRUE){"
"0","    for(i in 1:length(axTicks(2))){"
"0","      abline(h = axTicks(2)[i],"
"0","             lwd = grid_lwd,"
"0","             lty = grid_lty,"
"0","             col = grid_col)"
"0","    }"
"0","  }"
"0","  x_range <- par('usr')[2] - par('usr')[1]"
"0","  y_range <- par('usr')[4] - par('usr')[3]"
"0","  # ------------------------------------------------------------------------------------------------"
"0","  "
"0","  "
"0","  # ------------------------------------------------------------------------------------------------"
"0","  for(i in 1:n_boxes){"
"0","    # ------------------------------------------------------------------------------------------------"
"0","    # draw main body of box"
"0","    rect(xleft = i - box_width[i],"
"0","         ybottom = bstats[2,i],"
"0","         xright = i + box_width[i],"
"0","         ytop = bstats[4,i],"
"0","         border = box_border[i],"
"0","         lwd = box_lwd[i],"
"0","         lty = box_lty[i],"
"0","         col = box_col[i])"
"0","    # ------------------------------------------------------------------------------------------------"
"0","    "
"0","    # ------------------------------------------------------------------------------------------------"
"0","    if(is.null(out) == FALSE){"
"0","      points(x = rep(i,length(out[[i]])),"
"0","             y = out[[i]],"
"0","             bg = box_col[i],"
"0","             col = box_border[i],"
"0","             pch = 21)"
"0","    }"
"0","    # ------------------------------------------------------------------------------------------------"
"0","    "
"0","    # ------------------------------------------------------------------------------------------------"
"0","    # draw median"
"0","    lines(x = c(i - box_width[i],"
"0","                i + box_width[i]),"
"0","          y = c(bstats[3,i],"
"0","                bstats[3,i]),"
"0","          col = box_border[i],"
"0","          lwd = box_lwd[i],"
"0","          lty = box_lty[i])"
"0","    # ------------------------------------------------------------------------------------------------"
"0","    "
"0","    # ------------------------------------------------------------------------------------------------"
"0","    # draw bottom whisker"
"0","    lines(x = c(i,i),"
"0","          y = c(bstats[2,i],"
"0","                bstats[1,i]),"
"0","          col = whisker_col[i],"
"0","          lwd = whisker_lwd[i],"
"0","          lty = whisker_lty[i])"
"0","    lines(x = c(i - whisker_width[i],"
"0","                i + whisker_width[i]),"
"0","          y = c(bstats[1,i],"
"0","                bstats[1,i]),"
"0","          col = whisker_col[i],"
"0","          lwd = whisker_lwd[i],"
"0","          lty = whisker_lty[i])"
"0","    # ------------------------------------------------------------------------------------------------"
"0","    "
"0","    "
"0","    # ------------------------------------------------------------------------------------------------"
"0","    # draw top whisker"
"0","    lines(x = c(i,i),"
"0","          y = c(bstats[4,i],"
"0","                bstats[5,i]),"
"0","          col = whisker_col[i],"
"0","          lwd = whisker_lwd[i],"
"0","          lty = whisker_lty[i])"
"0","    lines(x = c(i - whisker_width[i],"
"0","                i + whisker_width[i]),"
"0","          y = c(bstats[5,i],"
"0","                bstats[5,i]),"
"0","          col = whisker_col[i],"
"0","          lwd = whisker_lwd[i],"
"0","          lty = whisker_lty[i])"
"0","    # ------------------------------------------------------------------------------------------------"
"0","  }"
"0","  # ------------------------------------------------------------------------------------------------"
"0","  "
"0","  # ------------------------------------------------------------------------------------------------"
"0","  # labels or no labels"
"0","  if(box_labels_tf == TRUE){"
"0","    if('boxn' %in% box_labels){"
"0","      axis(1,"
"0","           at = c(1:n_boxes),"
"0","           labels = c(1:n_boxes))"
"0","    }"
"0","    "
"0","    if(!'boxn' %in% box_labels){"
"0","      axis(1,"
"0","           at = c(1:n_boxes),"
"0","           labels = rep('',n_boxes))"
"0","      for(i in 1:length(box_labels)){"
"0","        text(x = i,"
"0","             y = par('usr')[3] - y_range*label_y_offset[i],"
"0","             adj = label_pos,"
"0","             srt = label_srt[i],"
"0","             labels = box_labels[i],"
"0","             cex = label_cex[i],"
"0","             col = label_col[i],"
"0","             xpd = NA)"
"0","      }"
"0","    }"
"0","  }"
"0","  # ------------------------------------------------------------------------------------------------"
"0","  "
"0","  "
"0","  # ------------------------------------------------------------------------------------------------"
"0","  if(is.null(title) == FALSE){"
"0","    text(x = par('usr')[1] - x_range*title_x_offset,"
"0","         y = par('usr')[4] + y_range*title_y_offset,"
"0","         pos = title_pos,"
"0","         labels = title, "
"0","         cex = title_cex,"
"0","         col = title_col,"
"0","         xpd = NA)"
"0","  }"
"0","  "
"0","  if(is.null(subtitle) == FALSE){"
"0","    text(x = par('usr')[1] - x_range*subtitle_x_offset,"
"0","         y = par('usr')[4] + y_range*subtitle_y_offset,"
"0","         pos = subtitle_pos,"
"0","         labels = subtitle, "
"0","         cex = subtitle_cex,"
"0","         col = subtitle_col,"
"0","         xpd = NA)"
"0","  }"
"0","  # ------------------------------------------------------------------------------------------------"
"0","  box()"
"0","}"
"0","# ------------------------------------------------------------------------------------------------"
