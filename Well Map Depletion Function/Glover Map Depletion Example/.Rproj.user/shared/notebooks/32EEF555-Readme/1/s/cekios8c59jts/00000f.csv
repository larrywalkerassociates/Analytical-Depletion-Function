"0","#-------------------------------------------------------------------------------"
"0","# make grid and centroids"
"0","grid <- st_make_grid(Shasta_B118,"
"0","                     cellsize = 1000)"
"0",""
"0","centroids <- st_centroid(grid)"
"0","centroids <- st_intersection(centroids, Shasta_B118$geometry)"
"0","#-------------------------------------------------------------------------------"
"0",""
"0","#-------------------------------------------------------------------------------"
"0","# find influence radius"
"0","dist_matrix <- st_distance(centroids, Shasta_Streams)"
"0","diag(dist_matrix) <- NA"
"0","min_distances <- apply(dist_matrix, 1, min, na.rm = TRUE)"
"0",""
"0","influence_radius <- max(min_distances)*2"
"0","#-------------------------------------------------------------------------------"
